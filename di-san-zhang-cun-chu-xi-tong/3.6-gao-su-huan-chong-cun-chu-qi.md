# 3.6 高速缓冲存储器

## 3.6.1 局部性原理

**时间局部性**：在最近的未来要用到的信息，很可能是现在正在使用的信息

**空间局部性**：在最近的未来要用到的信息（指令和数据），很可能与现在正在使用的信息在存储空间上是邻近的

## 3.6.2 Cache的工作原理

基于局部性原理，可以把CPU目前访问的地址周围的部分数据放到Cache中。

将主存与Cache分为同样大小的块（见操作系统“分页”相关内容），**主存和Cache之间以块为单位进行数据交换**。系统访问主存时，会将这一块的内容同时复制到Cache中。

### Cache的性能分析

**命中率**H：CPU欲访问的信息已在Cache中的比率

**缺失（未命中）率**：$$M=1-H$$ 

{% hint style="info" %}
设 $$t_{c}$$为访问一次Cache所需时间， $$t_{m}$$为访问一次主存所需时间，则Cache-主存系统的平均访问时间t为

$$t=H\cdot t_{c}+(1-H)(t_{c}+t_{m})$$ 

**先访问Cache，若Cache未 命中再访问主存**

或是 $$t=H\cdot t_{c}+(1-H)t_{m}$$ 

同时访问Cache和主存，**若Cache命中则立即停止访问主存**
{% endhint %}

## 3.6.3 Cache和主存的映射方式

### 1、全相联映射

主存块可以存放在Cache的任何位置。

